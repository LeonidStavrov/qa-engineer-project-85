---
- summary: |
    Проверка успешной регистрации с валидными данными
  requirement: |
    При вводе корректных данных пользователь должен зарегистрироваться в системе
  prerequisites: |
    Открыта главная страница
  test-data: |
    Свободный Nickname
    Email
    Придумываем Password
  steps:
    - Нажать "Sign up"
    - Ввести имя в поле Nickname
    - Ввести почтовый адрес в поле Email
    - Ввести пароль в поле Password
    - Повторить пароль в поле Password confirmation
    - Нажать кнопку Submit
  expected-result: |
    - Пользователь перенаправлен на главную страницу
    - Отображается список лобби
    - В правом верхнем углу отображается имя пользователя

- summary: |
    Невозможность регистрации с некорректным email
  requirement: |
    Система должна блокировать регистрацию с некорректным email
  prerequisites: |
    Открыта страница регистрации
  test-data: |
    Свободный Nickname
    Email без символа "@"
    Придумываем Password
  steps:
    - Ввести имя в поле Nickname
    - Ввести почтовый адрес без "@" в поле Email
    - Ввести пароль в поле Password
    - Повторить пароль в поле подтверждения
    - Нажать кнопку Submit
  expected-result: |
    - Появилось сообщение "Invalid email"
    - Пользователь остался на странице регистрации

- summary: |
    Проверка входа через GitHub OAuth
  requirement: |
    Пользователь должен авторизоваться через GitHub без ввода данных на сайте
  prerequisites: |
    Открыта главная страница
    GitHub-аккаунт не привязан к другим профилям
  test-data: |
    Нет
  steps:
    - Нажать кнопку "Sign up with Github"
    - Авторизоваться на GitHub
    - Подтвердить разрешения для Codebattle
  expected-result: |
    - Пользователь перенаправлен на главную страницу
    - Отображается список лобби
    - GitHub аккаунт отображается в профиле
    - В правом верхнем углу отображается имя пользователя

- summary: |
    Проверка восстановления пароля
  requirement: |
    Система должна отправлять письмо для сброса пароля на указанный email
  prerequisites: |
    Открыта главная страница
  test-data: |
    Зарегистрированный почтовый адрес
  steps:
    - Нажать "Sign in"
    - Нажать "Forgot your password?"
    - Ввести свою почту в поле Email
    - Нажать кнопку "Submit"
  expected-result: |
    - Появилось уведомление об отправке письма
    - Письмо с ссылкой для восстановления пароля доставлено на указанную почту

- summary: |
    Проверка ссылки для восстановления пароля
  requirement: |
    Нажатие по ссылке из письма должно открывать страницу для восстановления пароля
  prerequisites: |
    Открыто письмо с ссылкой
  test-data: |
    Нет
  steps:
    - Нажать на ссылку из письма
  expected-result: |
    - Открылась страница с окном для нового пароля

- summary: |
    Проверка изменения пароля на странице восстановления
  requirement: |
    Система должна позволить изменить пароль по ссылке из письма
  prerequisites: |
    Открыта страница с окном для нового пароля
  test-data: |
    Новый пароль
  steps:
    - Ввести новый пароль в поле "New password"
    - Нажать Save
  expected-result: |
    - Появилось сообщение о смене пароля

- summary: |
    Проверка входа после изменения пароля
  requirement: |
    Пользователь должен войти в систему, используя новый пароль
  prerequisites: |
    Открыта страница авторизации
  test-data: |
    Пароль после восстановления
  steps:
    - Ввести Email
    - Ввести новый пароль
    - Нажать Submit
  expected-result: |
    - Пользователь перенаправлен на главную страницу
    - Отображается список лобби
    - В правом верхнем углу отображается имя пользователя

- summary: |
    Проверка гостевого режима
  requirement: |
    Система должна позволять пробную игру без авторизации
  prerequisites: |
    Пользователь не авторизован
  test-data: |
    Нет
  steps:
    - Нажать кнопку "Try simple battle"
    - Дождаться загрузки игровой сессии
  expected-result: |
    - Открыта страница с игрой
    - Поле для ввода кода доступно для редактирования

- summary: |
    Проверка создания игры с ботом
  requirement: |
    Пользователь должен создавать игру с указанными параметрами
  prerequisites: |
    Пользователь авторизован
  test-data: |
    Level = easy
    Game type = With a bot
    Time control = 8 min
    Task = pizza_volume
  steps:
    - Нажать "Create a game"
    - Установить указанные параметры
    - Нажать "Create battle"
    - Дождаться загрузки
  expected-result: |
    - Открыта игровая сессия с ботом
    - Параметры соответствуют заданным

- summary: |
    Проверка поведения программы при выйгрыше
  requirement: |
    Система должна уведомить игрока о победе
  prerequisites: |
    Создана игра с другом
  test-data: |
    Нет
  steps:
    - Один из игроков должен сдаться
  expected-result: |
    - У победившего игрока всплывает сообщение о победе с картинкой, сопровождающееся кратковременным звуковым сигналом
    - В статистике увеличивается значение "Won" на 1

- summary: |
    Проверка поведения программы при проигрыше
  requirement: |
    Система должна уведомить игрока о поражении
  prerequisites: |
    Создана игра с другом
  test-data: |
    Нет
  steps:
    - Один из игроков должен сдаться
  expected-result: |
    - У проигравшего игрока всплывает сообщение о проигрыше с картинкой, сопровождающееся кратковременным звуковым сигналом
    - В статистике увеличивается значение "Lost" на 1

- summary: |
    Проверка поведения программы при сдаче
  requirement: |
    Система должна уведомить игрока о поражении
  prerequisites: |
    Создана игра с ботом
  test-data: |
    Нет
  steps:
    - Нажать 3 точки над редактором кода
    - Нажать "Give up"
  expected-result: |
    - У сдавшегося игрока всплывает сообщение о проигрыше с картинкой, сопровождающееся кратковременным звуковым сигналом
    - В статистике увеличивается значение "Gave up" на 1

- summary: |
    Проверка поведения программы при окончании таймера
  requirement: |
    Система должна уведомить игрока об окончании игры
  prerequisites: |
    Создана игра с другом с установленным таймером на 3 минуты
  test-data: |
    Нет
  steps:
    - Подождать 3 минуты
  expected-result: |
    - Вместо таймера появляется сообщение "GAME_OVER"
    - В статистике увеличивается значение "Lost" на 1

- summary: |
    Проверка приглашения в игру
  requirement: |
    Система должна отправлять уведомление приглашенному пользователю
  prerequisites: |
    Оба пользователя авторизованы
  test-data: |
    Level = elementary
    Game type = With a friend
  steps:
    - Создать игру с указанными параметрами
    - Нажать "Invite"
    - Выбрать пользователя из списка
  expected-result: |
    - У пригласившего пользователя появляется уведомление в чате об отправке приглашения
    - У приглашенного появилось уведомление в правом верхнем игру на иконке с мечами
    - Уведомление содержит информацию об игре

- summary: |
    Проверка принятия приглашения в игру
  requirement: |
    Система должна позволять пользователю принять приглашение в игру
  prerequisites: |
    Оба пользователя авторизованы
  test-data: |
    Нет
  steps:
    - Нажать на иконку с уведомлением
    - Нажать "Accept"
  expected-result: |
    - У игроков одновременно открывается лобби
    - Ник противника совпадает с приглашенным игроком

- summary: |
    Проверка отклонения приглашения в игру
  requirement: |
    Система должна позволять пользователю отклонить приглашение в игру
  prerequisites: |
    Оба пользователя авторизованы
  test-data: |
    Нет
  steps:
    - Нажать на иконку с уведомлением
    - Нажать "Decline"
  expected-result: |
    - У пригласившего пользователя появляется уведомление в чате об отклонении приглашения
    - Страница, на которой находится пользователь, не должна измениться

- summary: |
    Проверка выбранного языка программирования в игре
  requirement: |
    Система должна применять синтаксис, соответствующий выбранному языку программирования
  prerequisites: |
    Игра запущена
  test-data: |
    Python
  steps:
    - Выбрать из выпадающего списка с языками Python
  expected-result: |
    - Синтаксис заготовленного блока кода в редакторе должен соответствовать Python

- summary: |
    Проверка редактирования профиля
  requirement: |
    Пользователь должен изменять и сохранять данные профиля
  prerequisites: |
    Пользователь авторизован
    Открыта страница настроек профиля
  test-data: |
    Придумать новый Nickname
  steps:
    - Изменить Nickname на новый
    - Изменить Your weapon на другой язык программирования
    - Нажать "Save"
    - Перезагрузить страницу
  expected-result: |
    - Данные сохранились после перезагрузки
    - Новые значения отображаются в профиле

- summary: |
    Проверка просмотра истории игр
  requirement: |
    Система должна отображать историю завершенных игр
  prerequisites: |
    Пользователь авторизован
    Есть завершенные игры
  test-data: |
    Нет
  steps:
    - Перейти в раздел "History"
    - Выбрать любую завершенную игру
    - Нажать "Show"
  expected-result: |
    - Открылась страница с деталями игры
    - Доступно воспроизведение хода игры

- summary: |
    Проверка чата в игровой сессии
  requirement: |
    Система должна поддерживать обмен сообщениями между игроками
  prerequisites: |
    Активная игровая сессия с двумя игроками
  test-data: |
    Message = "Test message"
  steps:
    - Ввести "Test message" в поле чата
    - Нажать кнопку отправки
  expected-result: |
    - Сообщение появилось в чате
